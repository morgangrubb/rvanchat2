.row#candyContainer
  .col-md-9
    %iframe#candy( width="100%" height="100%" src="#{candy_path}" frameBorder="0" scrolling="no" allowTransparency="true" style="background-color: transparent;")
  .col-md-3
    .well
      %h5 To connect your own XMPP/Jabber client
      %p
        %b User:
        = current_user.jid
      %p
        %b Password:
        = current_user.xmpp_password
      %p
        %b Group chat:
        = current_user.rooms.first.jid

      %hr/

      %p
        = link_to "Logout", destroy_user_session_path, method: :delete

- content_for :javascript do
  :javascript
    $(function() {
      resizeIframe = function() {
        totalAvailable = $( window ).height();

        // Find all the children of the parent element
        allChildren = $('#candyContainer').parent().children()

        // Get the heights of every one that isn't the one we're interested in
        otherHeights = 0;
        allChildren.each(function(i) {
          $element = $(this);
          if (!$element.is('#candyContainer')) {
            otherHeights += $element.outerHeight(true);
          }
        });

        // Set our new height
        $('#candyContainer iframe').height(totalAvailable - otherHeights - 20);
      }

      $(window).resize(resizeIframe);
      resizeIframe();
    })
